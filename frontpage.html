<!DOCTYPE html>
<html lang="en">
<head>

	<meta charset="utf-8">
	<link href="./style.css" type="text/css" rel="stylesheet"/>
	<link href="https://fonts.googleapis.com/css?family=ABeeZee|Montserrat|Quicksand&display=swap" rel="stylesheet"> 
	<title>Address Book (one-use)</title>

</head>

<body>
<header>
	<nav>
		<ul>
		  <li><a href="./frontpage.html" class="active-page">Home</a></li>
		  <li><a href="./about.html">About</a></li>
		</ul>
	</nav>
</header>

<section class="overlay">
	<h1>ADDRESS BOOK</h1>
	<hr>
	<h2>Welcome. Please begin by filling in the forms below to flesh out the address book.</h2>
	<div class="form">
		<form>
			<label for="firstname">Name:
				<input id="firstname" name="firstname" type="text" required minlength="1">
			</label>
			<hr>
			<label for="surname">Surname:
				<input id="surname" name="surname" type="text" required minlength="2">
			</label>
			<hr>
			<label for="phonenumber">Phone number (landline):
    			<input type="number" name="phonenumber" id="phonenumber" min="10" size="15" required>
			</label>
			<hr>
			<label for="housenumber">House number:
    			<input type="number" name="housenumber" id="housenumber" min="1" size="4" required>
			</label>
			<hr>	
			<label for="email">Email:
    			<input class="emailaddress" type="text" name="email" id="email" required >
			</label>
			<hr>
			<label for="firstline">Street:
    			<input class="street" type="text" name="firstline" id="firstline" required >
			</label>
			<hr>
			<label class="urban" for="city">City:
    			<input type="text" name="city" id="city" required>
			</label>
			<hr>
			  <label class="extra-info" for="extra">A short description of your home (optional)
			  <br>
			  <textarea id="extra" name="extra">You may include a brief description of your home here if you wish.</textarea>
			</label>
			<br>
			<input id="submitbutton" type="submit" value="Add entry to address book">			
		</form>
	</div>	
</section>

<section class="entries">
	<h1>ENTRIES DISPLAYED BELOW</h1>
	<hr>
	<label for="search">Search entries:
		<input id="searchValue" type="text" minlength="1">
	</label>
	<table id="myTable">
		<thead>
		<tr>
			<th>First name</th>
			<th>Surname</th>
			<th>Phone number</th>
			<th>House number</th>
			<th>Email</th>
			<th>Street</th>
			<th>City</th>
			<th>Extra info</th>
			<th>Delete?</th>
		</tr>
		</thead>
		<tbody id="entryRows">
		</tbody>
	</table>
	<div class="initMessage">
		<p><i> No entries found.</i></p>
	</div>
</section>

<section class="buttonbar">
	<button id="viewbook">View Address Book</button>
</section>
</body>

<footer>
    <address>
        <a href="https://c.wallhere.com/photos/65/8a/sf_sanfrancisco_california_street_city_houses_wallpaper_usa-951748.jpg!d">Background</a> has been used under the Creative Commons license
    </address>
	
</footer> 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
$(function () {
	// Initial state of page
	var addressBook = [];
	$('.entries').hide();
	$('.searchMessage').hide();
	
	// Validation step
	var textFields = [$("#firstname"),$("#surname") , $("#firstline"),$("#city" )];
	
		
	textFields.forEach(function(field){
		field.keypress(function(e) {
			// Backspace, tab, space, apostrophe, hyphen, delete - no special characters accounted for. Paste does work - which is why there is a next step to account for this. 
			var validNonAlphaNumKeys = [8, 9, 32, 39, 45, 46];
			
			var key = e.which || e.keyCode;
			
			var validKey = validNonAlphaNumKeys.join(",").match(new RegExp(key));

			if (validKey) {
				return;
			}
			
			if (90 < key && key < 97) {
				e.preventDefault();
				return;
			}			
			else if (64 > key || key > 123){
				e.preventDefault();
				return;
			}
			
		});
	
	});
		
	// Upon submitting an entry
	$( "form" ).submit(function(event) {	
		
					
		// Formatting form data and storing it
		var arr = $('form').serializeArray();
		
		if (arr[7].value === "You may include a brief description of your home here if you wish.")
		{
			arr[7].value = "No information entered.";
		} 			
		addressBook.push(arr);		
		
		// Resets form after pushing entry
		$('form').trigger('reset'); 

		
		//Display table	by adding entries one at a time
		appendTable = function(index){
		$('#entryRows').append('<tr><td>' + `${addressBook[index][0].value}` + '</td><td>' + `${addressBook[index][1].value}` + '</td><td>' 
		+ `${addressBook[index][2].value}` + '</td><td>' + `${addressBook[index][3].value}` + '</td><td>' + `${addressBook[index][4].value}` + '</td><td>'
		+ `${addressBook[index][5].value}` + '</td><td>' + `${addressBook[index][6].value}` + '</td><td>' + `${addressBook[index][7].value}` + '</td><td><button id="deletebutton">Delete entry?</button></td></tr>'
		);};
		
		appendTable(addressBook.length - 1);

		

		
		// Prevent form from submitting (default function)
		event.preventDefault();
	});
	
	$('form').on("submit", function () {
		$('.initMessage').hide();
	});
-	
	// Delete button
	$('#entryRows').on('click','#deletebutton',function(){
		if (confirm('Delete this entry?')){
			$(this).closest('tr').hide('slow', function(){ 
				$target.remove(); 
			});
		}
	});
	
	// Search function - dynamic
	$('form').on("submit", function () {
		$("#searchValue").on("keyup", function() {
			var value = $(this).val().toLowerCase();
			$("#entryRows tr").filter(function() {
				var match = $(this).text().toLowerCase().indexOf(value);
				$(this).toggle(match > -1)
		});
	  });
	});

	
	// Modify button - appears on search match
	


	// Coding the "View Address Book" button
	$('#viewbook').click(function(){
		$('.overlay').toggle("hide");
		$('.entries').toggle("show");
		$(this).text($(this).text() === 'Hide Address Book' ? 'View Address Book' : 'Hide Address Book');		
	});
});

</script>
</html>
